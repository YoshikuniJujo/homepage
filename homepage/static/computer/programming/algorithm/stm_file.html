STMの考え方によるファイルの書き込み

<h2>動機</h2>

webサーバでのログ取り。

<h2>アルゴリズム</h2>

<ol>
<li>実行中のスレッド用のローカルなディレクトリを作成する</li>
<li>ログファイルを読み込む</li>
<li>「変更前」のハッシュ値をローカルなディレクトリに保存する</li>
<li>「変更後」のファイルをローカルなディレクトリに保存する</li>
<li>ロックを取得する</li>
<li>ログファイルを読み込み、ハッシュ値をチェックする</li>
<li>ローカルのハッシュ値と一致したら「変更後」のファイルで上書きし終了</li>
<li>ロックを解放する</li>
<li>「変更前」のハッシュ値をローカルなディレクトリに保存しくりかえす</li>
</ol>
