Maybe型からの値の取り出し

<h2>はじめに</h2>

<p>多相関数の例として以下を見ていこう。</p>

<ul>
<li>fromMaybe</li>
<li>maybe</li>
</ul>

<p>どちらもMaybe型から値を取り出す関数だ。</p>

<h2>関数fromMaybe</h2>

<p>デフォルトの値を指定し値がNothingのときはそれを返す。</p>

<p><code>% ghci<br/>
Prelude&gt; :m Data.Maybe<br/>
Prelude Data.Maybe&gt; fromMaybe 0 (Just 8)<br/>
8<br/>
Prelude Data.Maybe&gt; fromMaybe 0 Nothing<br/>
0<br/>
Prelude Data.Maybe&gt; fromMaybe ' ' (Just 'c')<br/>
'c'</code></p>

<h3>定義</h3>

<p>定義は以下のようになる。</p>

<p><code>fromMaybe _ (Just x) = x<br/>
fromMaybe d _ = d</code></p>

<p>
Maybe型の値がJust値のときは中身の値を、そうでなければ第1引数の値を返す。
</p>

<h3>型</h3>

<p>型は以下のようになる。</p>

<p><code>fromMaybe :: a -&gt; Maybe a -&gt; a</code></p>

<p>
Maybe型の中身、デフォルト値、返り値はすべて同じ型でなければならない。
それらを同じ型変数aで表す。
</p>

<h2>関数maybe</h2>

<p>
関数fromMaybeはデフォルト値を決めて値を取り出す関数だ。
関数maybeのほうはデフォルト値を決めて値に関数を適用する関数である。
</p>

<p><code>% ghci<br/>
Prelude&gt; :m Data.Char<br/>
Prelude Data.Char&gt; maybe False isLower (Just 'c')<br/>
True<br/>
Prelude Data.Char&gt; maybe False isLower Nothing<br/>
False<br/>
Prelude Data.Char&gt; maybe 0 ord (Just 'c')<br/>
99<br/>
Prelude Data.Char&gt; maybe 0 ord Nothing<br/>
0</code></p>

<h3>定義</h3>

<p>定義は以下のようになる。</p>

<p><code>maybe _ f (Just x) = f x<br/>
maybe d _ _ = d</code></p>

<p>
Maybe型の値がJust値のときは中身の値に引数で与えられた関数を適用し、
そうでなければデフォルト値を返す。
</p>

<h3>型</h3>

<p>型は以下のようになる。</p>

<p><code>maybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b</code></p>

<p>
Maybe型の中身の型aの値を型bの値に変換する関数が第2引数だ。
デフォルト値は変換後の値と同じ型でなければならないので型はbとなる。
返り値も同様にb型の値である。
</p>

<h2>まとめ</h2>

<p>
Maybe型から値を取り出す関数を見た。
関数fromMaybeと関数maybeは
ともにデフォルト値を指定することでNothing値に対応している。
前者は直接値を取り出し後者は関数適用することで値を取り出す。
</p>

<p>
前者はなかの値をいじらないことで多相性を維持している。
後者では値の操作を引数として取った関数にまかせることで多相性を維持している。
多相関数の多くは引数として取った関数で値の変換を行うことが多い。
つまり多相関数の多くは同時に高階関数である。
</p>

<h2>課題</h2>

<ol>
<li>[挑戦問題] 2つのMaybe型の値がともにJust値だったら、それらに2引数関数を適用する関数maybe2を定義せよ</li>
<li>[挑戦問題] 関数maybe2の型を決めよ</li>
</ol>

<p>
<a href="/computer/haskell/web_lecture/for_programmer/polymorphic.html"
	>「多相関数とは」へもどる</a>
<a href="/computer/haskell/web_lecture/for_programmer/id.html"
	>「そのままにする関数」へ</a>
</p>
