リストによる「くりかえし」: ろ過

<h2>3の倍数のみ</h2>

<p>
0からnまでの整数の総和を求める関数は求められた。
次は0から3nまでの整数のうち3の倍数のもののみの総和を求めてみよう。
手続き的に考えると以下のようになるだろう。
</p>

<ol>
<li>変数i, sを用意</li>
<li>変数i, sを0で初期化</li>
<li>iが3の倍数であればsにiを足したものをsに代入</li>
<li>iに1足したものをiに代入</li>
<li>iが3n以下であれば3へ、そうでなければ6へ</li>
<li>変数sの値が求める値となる</li>
</ol>

<p>リストを使った方法では以下のようになる。</p>

<ol>
<li>0から3nまでの整数のリストを作成</li>
<li>そのリストから3の倍数だけを取り出したリストを作成</li>
<li>そのリストの総和を求める</li>
</ol>

<h2>ろ過</h2>

<p>
リストから条件を満たすものだけを取り出したリストを作成することを「ろ過」と呼び、
ろ過を行う関数filterが用意されている。
関数filterは第1引数にBool値を返す関数を取る。
3の倍数かどうかを判断する関数は以下のよう表現できる。
</p>

<pre><code>(== 0) . (`mod` 3)</code></pre>

<p>
3で割った余りが0と等しければ、もともとの値は3の倍数である。
列挙と総和のあいだにfilterによるろ過をはさめば良いので、
求める関数は以下のようになる。
</p>

<p><a href="/computer/haskell/web_lecture/for_programmer/10_filter/sum3N.hs"
	>sum3N.hs</a></p>

<pre><code>sum3N :: Integer -&gt; Integer
sum3N n = sum $ filter ((== 0) . (`mod` 3)) [0 .. 3 * n]</code></pre>

<p>試してみる。</p>

<pre><code>% ghci sum3N.hs
*Main&gt; sum3N 10
165</code></pre>

<h2>まとめ</h2>

<p>
列挙したもののなかで条件を満たしたものだけを蓄積の対象にする方法を学んだ。
もとのリストから要素をしぼり込んだ新しいリストを作成すれば良い。
しぼり込む段階をろ過と呼び、関数filterが用意されている。
関数filterの第1引数はBool値を返す関数となる。
</p>

<p>
<a href="/computer/haskell/web_lecture/for_programmer/enum_accum.html"
	>「列挙と蓄積」へもどる</a>
<a href="/computer/haskell/web_lecture/for_programmer/map.html"
	>「転写」へ</a>
</p>
