カリー化

<h2>自己紹介</h2>

<p>
名前と年齢をまとめたタプルを引数にして自己紹介の文字列を返す関数を考える。
関数showは値を表示用の文字列に変換する関数だ。
</p>

<p><a href="/computer/haskell/web_lecture/for_programmer/08_curry/introduction.hs"
	>introduction.hs</a></p>

<pre><code>introduction :: (String, Integer) -&gt; String
introduction (n, a) =
	"My name is " ++ n ++
	". I'm " ++ show a ++ " years old."</code></pre>

<p><code>% ghci introduction.hs<br/>
*Main&gt; introduction ("Yoshikuni Jujo", 34)<br/>
"My name is Yoshikuni Jujo. I'm 34 years old."<!--
*Main&gt; introduction ("Jun Natsukawa", 34)
"My name is Jun Natsukawa. I'm 34 years old."--></code></p>

<h2>年齢は変わる</h2>

<p>名前は変わらないが年齢は変わる。サバを読むこともある。</p>

<p><code>*Main&gt; introduction ("Yoshikuni Jujo", 10)<br/>
"My name is Yoshikuni Jujo. I'm 10 years old."</code></p>

<p>
これで「どうして解散するんですか?」というページを作ればみんな見てくれる。
バレたら本当のことを言おう。
</p>

<p><code>*Main&gt; introduction ("Yoshikuni Jujo", 34)<br/>
"My name is Yoshikuni Jujo. I'm 34 years old."</code></p>

<p>
サバ読むときやバレたときのことを考えると
"Yoshikuni Jujo"専用の自己紹介関数を作っておきたい。
名前だけに部分適用しよう。
しかし、名前と年齢はタプルにまとまっている。部分適用できない。
</p>

<h2>そこでカリー化ですよ</h2>

<h3>カリー化とは</h3>

<p>
「カリー化」によって「複数の引数を取る関数」は「関数を返す関数」に変換され
部分適用できるようになる。
Haskellでは「複数の引数を取る関数(のようなもの)」は
そもそも「関数を返す関数」である。
「複数の引数を取る関数(のようなもの)」ははじめからカリー化されている。
他の言語での「複数の引数を取る関数」は
Haskellの「タプルを引数に取る関数」に相当する。
よって、Haskellでのカリー化は「タプルを引数に取る関数」を
「複数の引数を取る関数(のようなもの)」に変換することとなる。
</p>

<h3>カリー化を試す</h3>

<p>カリー化を対話環境で試してみよう。</p>

<p><code>*Main&gt; :t introduction<br/>
(String, Integer) -&gt; String<br/>
*Main&gt; :t curry introduction<br/>
String -&gt; Integer -&gt; String<br/>
*Main&gt; curry introduction "Yoshikuni Jujo" 34<br/>
"My name is Yoshikuni Jujo. I'm 34 years old."</code></p>

<p>
タプルとして与えるべき引数をばらばらに与えられる。
これを使ってYoshikuni Jujo専用の自己紹介関数を作成する。
</p>

<p><code>introductionYj :: Integer -&gt; String<br/>
introductionYj = curry introduction "Yoshikuni Jujo"</code></p>

<p>試してみよう。</p>

<p><code>*Main&gt; :reload<br/>
*Main&gt; introductionYj 34<br/>
"My name is Yoshikuni Jujo. I'm 34 yeras old."<br/>
*Main&gt; introductionYj 10<br/>
"My name is Yoshikuni Jujo. I'm 10 years old."</code></p>

<h2>関数curryの定義</h2>

<p>
関数curryは「引数としてタプルを期待する関数」の引数をばらばらにする。
定義はどうなっているだろうか。
</p>

<h3>型</h3>

<p>
上の例は<code>(String, Integer) -&gt; String</code>を
<code>String -&gt; Intege -&gt; String</code>に変換している。
</p>

<p><code>((String, Integer) -&gt; String) -&gt; (String -&gt; Integer -&gt; String)</code></p>

<p>
より一般的な形では
</p>

<p><code>((a, b) -&gt; c) -&gt; (a -&gt; b -&gt; c)</code></p>

<p>
「(a, b)型のタプルを取って返り値cを返す関数」を
「a型の値とb型の値を取って返り値cを返す関数」に変換する。
'-&gt;'は右結合なので右側の丸括弧は省略できる。
</p>

<p><code>((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c</code></p>

<p>
このように右側の丸括弧を省略することで以下のように読める。
「タプルを取る関数」とそのタプルの第1要素と第2要素を引数として取り
「第1引数の関数の返り値の型」の値を返す。
</p>

<h3>定義</h3>

<p>以下のように定義できる。</p>

<p><code>curry :: ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c<br/>
curry f x y = f (x, y)</code></p>

<img
alt="[関数curryの図]"
src="/computer/haskell/web_lecture/for_programmer/images/curry.svg"
/>

<p>
関数curryの第2引数xと第3引数yをタプルにまとめて関数fに与えている。
つまり、ばらばらの引数をタプルにまとめるという仕事をしている。
</p>

<h2>課題</h2>

<p>
(
ここにcurryを使う例とcurryと似た関数の例のそれぞれを作成することで、
使いかたと作りかたの両面で理解を深める課題を置くこと。
)
</p>

<ol>
<li></li>
<li></li>
</ol>

<p>
<a href="/computer/haskell/web_lecture/for_programmer/dist_tuple.html"
	>「タプル: 原点からの距離」へもどる</a>
<a href="/computer/haskell/web_lecture/for_programmer/uncurry.html"
	>「非カリー化」へ</a>
</p>
