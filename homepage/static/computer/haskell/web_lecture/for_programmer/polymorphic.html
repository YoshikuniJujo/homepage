多相関数とは

<h2>複数の型に適用可能</h2>

<p>
多相関数とは複数の型に適用可能であるか、複数の型からどれかの型を返すか、
またはその両方の性質を持つ関数である。
</p>

<h2>2種類の多相関数</h2>

<p>
多相性にはパラメトリック多相とアドホック多相とがある。
アドホック多相は型クラスと結びついた概念であり、そこで説明する。
ここではパラメトリック多相について説明する。
</p>

<h3>パラメトリック多相</h3>

<p>
パラメトリック多相は型や関数の構造上、値の中身が問題にならないために、
どの型でも取ることができるという意味での多相性である。
たとえば、Maybe型から中身を取り出すfromMaybeという関数がある。
第1引数にデフォルト値を取り第2引数にMaybe値を取る。
以下のように使うことができる。
</p>

<p><code>% ghci<br/>
Prelude&gt; :m Data.Maybe<br/>
Prelude Data.Maybe&gt; fromMaybe 0 (Just 123)<br/>
123<br/>
Prelude Data.Maybe&gt; fromMaybe 0 Nothing<br/>
0</code></p>

<p>
Just値の中身を取り出すかNothingならデフォルトの値を返す。
このような操作はMaybe型が包む型が何であろうとも関係なく行うことができる。
この関数の型は以下のようになる。
</p>

<p><code>fromMaybe :: a -&gt; Maybe a -&gt; a</code></p>

<p>
この例における'a'を型変数と呼ぶ。
型変数は小文字からはじまる識別子でどの型でもこの部分に入れられることを示す。
ただし普通の「変数」と同じように同じ型変数には同じ型を入れる必要がある。
つまり以下はfromMaybeの型として正しい。
</p>

<p><code>Integer -&gt; Maybe Integer -&gt; Integer<br/>
Char -&gt; Maybe Char -&gt; Char<br/>
Bool -&gt; Maybe Bool -&gt; Bool</code></p>

<p>
以下のような型はfromMaybeの型として正しくない。
</p>

<p><code>Integer -&gt; Maybe Bool -&gt; Char</code></p>

<h2>制御構造</h2>

<p>
多相関数は扱っている値の中身には関係なく、
その値が含まれる構造全体に作用する関数と考えることができる。
多相関数が実現する機能の多くはHaskell以前の言語では関数ではなく
制御構造として特殊な構文となっている場合が多い。
Haskellでは、他の言語で特殊な構文とする必要のある様々な制御構造を、
単なる関数として定義することができる。
</p>

<h2>まとめ</h2>

<p>
Haskellでは値自体に影響しない関数を多相関数として定義することができる。
値自体ではなく値を包む構造を扱う関数である。
高階関数という性質と合わせて、一般的に使える制御構造を、
特殊な構文ではなく単なる関数として定義することを可能にする。
多相関数の例をわかりやすいものから見ていくことにしよう。
</p>

<p>
<a href="/computer/haskell/web_lecture/for_programmer/import.html"
	>「モジュールの読み込み」へもどる</a>
<a href="/computer/haskell/web_lecture/for_programmer/fromMaybe.html"
	>「Maybe型からの値の取り出し」へ</a>
</p>
